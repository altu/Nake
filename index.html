<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Nake by yevhen</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Nake</h1>
        <p class="header">Magic script-based C# task runner. C# V6 is supported!</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/yevhen/Nake/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/yevhen/Nake/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/yevhen/Nake">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/yevhen">yevhen</a></p>


      </header>
      <section>        
<img src="images/Nake-logo-full.png" style="max-width: 890px; border: none" align="middle" />
<h2 style="border-bottom: none">Nake is a magic task runner tool for .NET. It's a hybrid of Shovel and Rake. The DSL for defining tasks is uniquely minimal and it's just plain C# code! Nake is built on top of the latest Roslyn release so you can use all of the C# V6 features in you scripts and even more.</h2>

<h2>
<a name="how-to-install" class="anchor" href="#how-to-install"><span class="octicon octicon-link"></span></a>How to install</h2>

<p>There multiple ways in which Nake could be installed. You can install it by using NuGet <a href="https://www.nuget.org/packages/Nake">package</a>, or you can get it by downloading a <a href="https://github.com/yevhen/Nake/releases">standalone</a> executable from GitHub releases page, and of course you can always build it from sources. </p>

<p>To install Nake via NuGet, run this command in NuGet package manager console:</p>

<pre><code>PM&gt; Install-Package Nake
</code></pre>

<h2>
<a name="scripting-reference" class="anchor" href="#scripting-reference"><span class="octicon octicon-link"></span></a>Scripting reference</h2>

<div class="highlight highlight-cs"><pre><span class="err">#</span><span class="n">r</span> <span class="s">"System"</span>                             <span class="c1">// </span>
<span class="err">#</span><span class="n">r</span> <span class="s">"System.Core"</span>                        <span class="c1">//   #reference assemblies from the GAC </span>
<span class="err">#</span><span class="n">r</span> <span class="s">"System.Data"</span>                        <span class="c1">//    (these are referenced by default)</span>
<span class="err">#</span><span class="n">r</span> <span class="s">"System.Xml"</span>                         <span class="c1">//</span>
<span class="err">#</span><span class="n">r</span> <span class="s">"System.Xml.Linq"</span>                    <span class="c1">//</span>

<span class="err">#</span><span class="n">r</span> <span class="s">"WindowsBase, Version=4.0.0.0 ..."</span>   <span class="c1">//  you can reference assembly by its full name</span>
<span class="err">#</span><span class="n">r</span> <span class="s">"Packages\NUnit.2.6.2\nunit.dll"</span>     <span class="c1">//        or by using relative path</span>
<span class="err">#</span><span class="n">r</span> <span class="s">"C:\Orleans\SDK\Orleans.dll"</span>         <span class="c1">//            or by absolute path</span>

<span class="err">#</span><span class="n">load</span> <span class="s">"Other.csx"</span>                       <span class="c1">//      #load code from other script files</span>
<span class="err">#</span><span class="n">load</span> <span class="s">"Build\Another.csx"</span>               <span class="c1">//  (both absolute and relative paths are fine)</span>

<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>                           <span class="c1">//</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>                        <span class="c1">//      standard C# namespace imports</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>                      <span class="c1">//     (these are imported by default)</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>                      <span class="c1">//  </span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>       <span class="c1">//  </span>

<span class="k">using</span> <span class="nn">System.IO.Path</span><span class="p">;</span>                   <span class="c1">//    C# V6 "using static members" feature </span>
<span class="k">using</span> <span class="nn">System.Console</span><span class="p">;</span>                   <span class="c1">//      will make you scripts more terse</span>

<span class="n">WriteLine</span><span class="p">(</span><span class="s">"Are you ready? Y/N:"</span><span class="p">);</span>       <span class="c1">//      any code you put on the script level </span>
<span class="k">if</span> <span class="p">(</span><span class="n">ReadLine</span><span class="p">()</span> <span class="p">==</span> <span class="s">"N"</span><span class="p">)</span>                  <span class="c1">//  will run before any of the tasks are executed</span>
    <span class="n">Exit</span><span class="p">(</span><span class="s">"See you soon ..."</span><span class="p">);</span>           <span class="c1">//      (useful for one-off initialization)</span>

<span class="kt">var</span> <span class="n">greeting</span> <span class="p">=</span> <span class="s">"Hello"</span><span class="p">;</span>                 <span class="c1">//   you can override any script-level variables </span>
<span class="kt">var</span> <span class="n">who</span> <span class="p">=</span> <span class="s">"world"</span><span class="p">;</span>                      <span class="c1">//  with the values passed from the command line</span>

<span class="c1">/// Prints greeting                     //  this F#-style summary will be shown in the task listing</span>
<span class="na">[Task]</span> <span class="k">void</span> <span class="n">Welcome</span><span class="p">()</span>                   <span class="c1">//  [Task] makes method runnable from the command line</span>
<span class="p">{</span>                                       
    <span class="n">WriteLine</span><span class="p">(</span><span class="s">"{greeting},{who}!"</span><span class="p">);</span>     <span class="c1">//  forget ugly string.Format and string concatenation </span>
<span class="p">}</span>                                       <span class="c1">//  with built-in support for string interpolation</span>

<span class="na">[Task]</span> <span class="k">void</span> <span class="n">Tell</span><span class="p">(</span>
    <span class="kt">string</span> <span class="n">what</span> <span class="p">=</span> <span class="s">"Hello"</span><span class="p">,</span>              <span class="c1">//     for parameterized tasks you can supply</span>
    <span class="kt">string</span> <span class="n">whom</span> <span class="p">=</span> <span class="s">"world"</span><span class="p">,</span>              <span class="c1">//     arguments directly from the command line</span>
    <span class="kt">int</span> <span class="n">times</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>                      <span class="c1">//  (string, int and boolean arguments are supported) </span>
    <span class="kt">bool</span> <span class="n">quiet</span> <span class="p">=</span> <span class="k">false</span>                  <span class="c1">//  + special switch syntax for booleans (eg, --quiet)</span>
<span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">emphasis</span> <span class="p">=</span> <span class="n">quiet</span> <span class="p">?</span> <span class="s">""</span> <span class="p">:</span> <span class="s">"!"</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(;</span> <span class="n">times</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">;</span> <span class="n">times</span><span class="p">--)</span>
        <span class="n">WriteLine</span><span class="p">(</span><span class="s">"{what},{whom}{emphasis}"</span><span class="p">);</span>
<span class="p">}</span>                                   

<span class="na">[Step]</span> <span class="k">void</span> <span class="n">Clean</span><span class="p">()</span>                     <span class="c1">//      Steps are Tasks with 'run once' semantics      </span>
<span class="p">{</span>                                       <span class="c1">//  (the foundation of any popular build automation tool)</span>
    <span class="n">Delete</span><span class="p">(</span><span class="s">"{OutputPath}\*.*"</span><span class="p">);</span> 
<span class="p">}</span>                                   

<span class="na">[Step]</span> <span class="k">void</span> <span class="n">Build</span><span class="p">(</span><span class="kt">string</span> <span class="n">cfg</span> <span class="p">=</span> <span class="s">"Debug"</span><span class="p">)</span>
<span class="p">{</span>                                       
    <span class="n">Clean</span><span class="p">();</span>                            <span class="c1">//  unlike popular build automation tools, there is no any</span>
    <span class="p">-------</span>                             <span class="c1">//    special syntax to specify task (step) dependencies</span>
    <span class="n">MSBuild</span><span class="p">(</span><span class="s">"Nake.sln"</span><span class="p">,</span> <span class="n">cfg</span><span class="p">);</span>           <span class="c1">//      (it's just plain old C# method invocation)</span>
<span class="p">}</span>                                       

<span class="na">[Step]</span> <span class="k">void</span> <span class="n">Test</span><span class="p">()</span>
<span class="p">{</span>                                       
    <span class="n">Clean</span><span class="p">();</span>                            <span class="c1">//         you have complete control over decision,</span>
    <span class="n">Build</span><span class="p">();</span>                            <span class="c1">//     when and in what order dependent steps should run</span>
    <span class="p">-------</span>                             <span class="c1">//  (Nake will guarantee that any step will run only once)</span>
    <span class="n">NUnit</span><span class="p">(</span><span class="s">"{OutputPath}\*.Tests.dll"</span><span class="p">)</span>   
<span class="p">}</span>

<span class="na">[Step]</span> <span class="k">void</span> <span class="n">Publish</span><span class="p">(</span><span class="kt">bool</span> <span class="n">beta</span> <span class="p">=</span> <span class="k">false</span><span class="p">)</span>
<span class="p">{</span>                                       
    <span class="n">Test</span><span class="p">();</span>                             <span class="c1">//   sometimes, you need to execute the same step but with</span>
    <span class="n">Build</span><span class="p">(</span><span class="s">"Release"</span><span class="p">);</span>                   <span class="c1">//  different arguments. Unlike other build automation tools</span>
    <span class="p">------</span>                              <span class="c1">//  there is no special syntax to force step to run again - </span>
    <span class="n">Nuget</span><span class="p">(</span><span class="s">"Nake.nuspec"</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>          <span class="c1">//       you just invoke it with different arguments!</span>
<span class="p">}</span>                                       

<span class="kt">var</span> <span class="n">apiKey</span> <span class="p">=</span> <span class="s">"$NugetKey$"</span><span class="p">;</span>              <span class="c1">//  $var$ is the shortcut syntax for getting </span>
<span class="n">Push</span><span class="p">(</span><span class="n">apiKey</span><span class="p">,</span> <span class="s">"{PackagePath}"</span><span class="p">);</span>          <span class="c1">//      value of environment variable</span>

<span class="n">Write</span><span class="p">(</span><span class="s">"$NakeStartupDirectory$"</span><span class="p">);</span>        <span class="c1">//  these special environment variables</span>
<span class="n">Write</span><span class="p">(</span><span class="s">"$NakeScriptDirectory$"</span><span class="p">);</span>         <span class="c1">//   are automatically created by Nake</span>

<span class="n">Write</span><span class="p">(</span><span class="s">"{{esc}}"</span><span class="p">);</span>                       <span class="c1">//  will simply print {esc} (no string interpolation)</span>
<span class="n">Write</span><span class="p">(</span><span class="s">"$$esc$$"</span><span class="p">);</span>                       <span class="c1">//  will simply print $esc$ (no env variable inlining)</span>

<span class="k">class</span> <span class="nc">Azure</span>                             <span class="c1">//  namespace declarations cannot be used with scripts,</span>
<span class="p">{</span>                                       <span class="c1">//  but could be easily emulated with class declarations</span>
    <span class="k">class</span> <span class="nc">Queue</span>                         <span class="c1">//     and you can nest them infinitely as you like</span>
    <span class="p">{</span>    
<span class="na">        [Task]</span> <span class="k">void</span> <span class="n">Clean</span><span class="p">()</span>             <span class="c1">//     then from the command line you would invoke</span>
        <span class="p">{}</span>                              <span class="c1">//  this task by its full path (ie, azure.queue.clean)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="na">[Task]</span> <span class="k">void</span> <span class="n">Default</span><span class="p">()</span>                   <span class="c1">//     running Nake without any options </span>
<span class="p">{</span>                                       <span class="c1">//  will cause it to run the "default" task</span>
    <span class="n">Build</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<h2>
<a name="command-line-reference" class="anchor" href="#command-line-reference"><span class="octicon octicon-link"></span></a>Command line reference</h2>

<p>General syntax is: <code>Nake [options ...]  [VAR=VALUE ...]  [task ...]</code></p>

<div class="highlight highlight-cs"><pre><span class="p">&gt;</span> <span class="n">Nake</span> <span class="p">-</span><span class="n">f</span> <span class="s">"Nake.csx"</span> <span class="n">Log</span><span class="p">=</span><span class="m">1</span> <span class="n">build</span>        <span class="c1">//   set Log environment variable to 1 and</span>
                                        <span class="c1">//  then run Build() task from Nake.csx file </span>

<span class="p">&gt;</span> <span class="n">Nake</span> <span class="n">Log</span><span class="p">=</span><span class="m">1</span> <span class="n">build</span>                      <span class="c1">//  equivalent to the above as Nake will automatically try </span>
                                        <span class="c1">//   to use Nake.csx file if present in current directory</span>
</pre></div>

<p>Options:</p>

<pre><code>   -?  --help             Display help message and exit
   -v  --version          Display the program version and exit
   -q  --quiet            Do not echo informational messages to standard output
   -s  --silent           Same as --quiet but also suppresses user generated log messages
   -f  --nakefile FILE    Use FILE as Nake project file
   -d  --directory DIR    Use DIR as current directory
   -t  --trace            Enables task execution tracing and full stack traces in exception messages
       --debug            Enables full script debugging in Visual Studio
   -T  --tasks [PATTERN]  Display the tasks with descriptions matching optional PATTERN and exit
</code></pre>

<h3>
<a name="invoking-tasks" class="anchor" href="#invoking-tasks"><span class="octicon octicon-link"></span></a>Invoking tasks</h3>

<p>General syntax for invoking tasks and passing arguments is similar to the normal C# method invocation syntax, except <code></code> is used instead of <code>,</code> to separate task arguments, and <code>=</code> is used instead of <code>:</code> for specifying named argument values. Also, boolean arguments support special <code>--</code> switch syntax.</p>

<div class="highlight highlight-cs"><pre><span class="p">&gt;</span> <span class="n">Nake</span> <span class="n">build</span>                            <span class="c1">//  run Build task with default arg values</span>
<span class="p">&gt;</span> <span class="n">Nake</span> <span class="n">build</span> <span class="n">Release</span>                    <span class="c1">//  or with first positional argument set to 'Release'</span>
<span class="p">&gt;</span> <span class="n">Nake</span> <span class="n">build</span> <span class="n">cfg</span><span class="p">=</span><span class="n">Release</span>                <span class="c1">//  or with named argument 'cfg' set to 'Release'</span>
<span class="p">&gt;</span> <span class="n">Nake</span> <span class="n">build</span> <span class="n">Release</span> <span class="n">outDir</span><span class="p">=</span><span class="s">"C:\Temp"</span>   <span class="c1">//  you can mix positional and named arguments</span>
<span class="p">&gt;</span> <span class="n">Nake</span> <span class="n">build</span> <span class="p">;</span> <span class="n">test</span>                     <span class="c1">//  or invoke multiple tasks within a same session</span>
<span class="p">&gt;</span> <span class="n">Nake</span> <span class="n">build</span> <span class="err">`</span><span class="p">;</span> <span class="n">test</span>                    <span class="c1">//  also escape ';' when running in PowerShell console </span>
<span class="p">&gt;</span> <span class="n">Nake</span> <span class="n">publish</span> <span class="p">--</span><span class="n">beta</span>                   <span class="c1">//  invoke Publish task with 'beta' arg set to 'true'</span>
</pre></div>

<h2>
<a name="included-utility-reference" class="anchor" href="#included-utility-reference"><span class="octicon octicon-link"></span></a>Included utility reference</h2>

<p>Out-of-the box Nake includes a lot of useful convinient utility functions to help you with: </p>

<ul>
<li>running external tools, such as command-line commands or MSBuild</li>
<li>selecting and transforming file system paths (globber)</li>
<li>casual file system tasks, such as copying, moving, deleting files/folders </li>
<li>logging messages to console</li>
<li>working with environment variables</li>
<li>controlling Nake's runner</li>
<li>etc</li>
</ul><p>Check out table below for reference on using utility library:</p>

<table>
<thead><tr>
<th align="left">Class</th>
<th align="left">Functions</th>
</tr></thead>
<tbody>
<tr>
<td align="left"><a href="https://github.com/yevhen/Nake/wiki/Run">Run</a></td>
<td align="left">Running external tools: Cmd, MSBuild</td>
</tr>
<tr>
<td align="left"><a href="https://github.com/yevhen/Nake/wiki/App">App</a></td>
<td align="left">Controlling Nake's runner</td>
</tr>
<tr>
<td align="left"><a href="https://github.com/yevhen/Nake/wiki/Log">Log</a></td>
<td align="left">Logging messages to console</td>
</tr>
<tr>
<td align="left"><a href="https://github.com/yevhen/Nake/wiki/Env">Env</a></td>
<td align="left">Working with environment variables</td>
</tr>
<tr>
<td align="left"><a href="https://github.com/yevhen/Nake/wiki/FS">FS</a></td>
<td align="left">File-system tasks, such as cop/move/etc</td>
</tr>
<tr>
<td align="left"><a href="https://github.com/yevhen/Nake/wiki/FileSet">FileSet</a></td>
<td align="left">File path selection and transformation (globber)</td>
</tr>
<tr>
<td align="left"><a href="https://github.com/yevhen/Nake/wiki/Color">Color</a></td>
<td align="left">Printing to console in color</td>
</tr>
<tr>
<td align="left"><a href="https://github.com/yevhen/Nake/wiki/Location">Location</a></td>
<td align="left">Current directory and special paths (script, startup)</td>
</tr>
</tbody>
</table><p>Also, see 'by use-case' reference on <a href="https://github.com/yevhen/Nake/wiki">wiki</a>.</p>

<h2>
<a name="tips--tricks" class="anchor" href="#tips--tricks"><span class="octicon octicon-link"></span></a>Tips &amp; tricks</h2>

<div class="highlight highlight-cs"><pre><span class="k">class</span> <span class="nc">Azure</span>
<span class="p">{</span>                                       
    <span class="n">StorageAccount</span> <span class="n">account</span><span class="p">;</span>

    <span class="k">static</span> <span class="nf">Azure</span><span class="p">()</span>                      <span class="c1">//  this will run once before any of the </span>
    <span class="p">{</span>                                   <span class="c1">//  tasks in this namespace are executed</span>
        <span class="n">account</span> <span class="p">=</span> <span class="n">Init</span><span class="p">();</span>               <span class="c1">//  (useful for one-off initialization)</span>
    <span class="p">}</span>
<span class="p">}</span>  
</pre></div>

<h2>
<a name="backlog" class="anchor" href="#backlog"><span class="octicon octicon-link"></span></a>Backlog</h2>

<ul>
<li>Running on Mono</li>
<li>Interactive mode</li>
</ul><h2>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h2>

<p>Gimme your pull requests!</p>

<h2>
<a name="samples-and-documentation" class="anchor" href="#samples-and-documentation"><span class="octicon octicon-link"></span></a>Samples and Documentation</h2>

<p>Have a look at <a href="https://github.com/yevhen/Nake/blob/dev/Nake.csx">Nake.csx</a> or <a href="https://github.com/yevhen/Nake/blob/dev/Publish.csx">Publish.csx</a>. Those are the Nake files used to build and publish Nake itself (ye, we're eating our own dog food). Also, additional samples can be contributed to samples <a href="https://github.com/yevhen/Nake-samples">repository</a>.</p>

<h2>
<a name="community" class="anchor" href="#community"><span class="octicon octicon-link"></span></a>Community</h2>

<p>General discussion group could be found <a href="https://groups.google.com/forum/#!forum/naketool">here</a>. Also, for news you can follow Nake's <a href="https://twitter.com/NakeTool">official</a> twitter account (or <a href="https://twitter.com/yevhen">my</a> account for that matter). The twitter's hashtag is <code>#naketool</code>.</p>

<h2>
<a name="credits" class="anchor" href="#credits"><span class="octicon octicon-link"></span></a>Credits</h2>

<ul>
<li>Thanks to everyone in the Roslyn compiler team for making this happen</li>
<li>Thanks to all members of the <a href="https://github.com/scriptcs">scriptcs</a> team for lending me their script pre-processing code</li>
<li>Special thanks to <a href="https://twitter.com/aamartynenko">Anton Martynenko</a> for giving me an idea and steering Nake's DSL in the right direction</li>
<li>Hugs and kisses to my lovely Valery for being so patient and supportive, and for feeding me food and beer, while I was sitting in my cage working on Nake, instead of spending that time with her</li>
</ul><h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p>Apache 2 License</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-46291804-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
